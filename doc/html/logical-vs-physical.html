<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Differences between logical (row level) and physical (block level) replication</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto: bdr-list@2ndquadrant.com"><LINK
REL="HOME"
TITLE="BDR 2.0.6 Documentation"
HREF="index.html"><LINK
REL="UP"
TITLE="BDR overview"
HREF="overview.html"><LINK
REL="PREVIOUS"
TITLE="Concepts"
HREF="bdr-concepts.html"><LINK
REL="NEXT"
TITLE="Differences between BDR and trigger-based replication"
HREF="bdr-vs-trigger-based.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="website-docs.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=ISO-8859-1"><META
NAME="creation"
CONTENT="2023-04-11T13:16:52"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>BDR 2.0.6 Documentation</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="Concepts"
HREF="bdr-concepts.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="overview.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>Chapter 1. BDR overview</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="Differences between BDR and trigger-based replication"
HREF="bdr-vs-trigger-based.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="LOGICAL-VS-PHYSICAL"
>1.2. Differences between logical (row level) and physical (block level) replication</A
></H1
><P
>   BDR uses
   <A
HREF="http://www.postgresql.org/docs/current/static/logicaldecoding.html"
TARGET="_top"
>PostgreSQL's logical decoding feature</A
>
   to implement a low overhead logical replication solution. It has significant
   advantages - and some disadvantages - when compared to PostgreSQL's older
   physical (block-based)
   <A
HREF="http://www.postgresql.org/docs/current/static/warm-standby.html#STREAMING-REPLICATION"
TARGET="_top"
>streaming</A
>
   or
   <A
HREF="http://www.postgresql.org/docs/current/static/warm-standby.html"
TARGET="_top"
>archive-based</A
>
   replication with warm or
   <A
HREF="http://www.postgresql.org/docs/current/static/hot-standby.html"
TARGET="_top"
>hot standby</A
>
  </P
><P
>   Logical replication has a different set of trade-offs to physical
   block-based replication. It isn't clearly better or worse. Physical
   replication is a lot simpler, has less lag for big transactions, is
   supported by older versions and may require less disk I/O, but generally
   consumes more network bandwidth, can't replicate a subset of databases or
   tables, and can't support multi-master or cross-version/cross-arch
   replication. Which solution you should use depends on what you need to do.
  </P
><P
>   The major differences between physical replication and logical replication as implemented by BDR are:
   <P
></P
></P><UL
><LI
><P
>Multi-master replication is possible. All members are writable nodes that replicate changes.</P
></LI
><LI
><P
>Data from index writes, <TT
CLASS="LITERAL"
>VACUUM</TT
>, hint bits, etc are not sent over the network, so bandwidth requirements may be reduced - especially when compared to physical replication with <TT
CLASS="LITERAL"
>full_page_writes</TT
>.</P
></LI
><LI
><P
>There is no need to use <A
HREF="http://www.postgresql.org/docs/current/static/runtime-config-replication.html#GUC-HOT-STANDBY-FEEDBACK"
TARGET="_top"
><TT
CLASS="LITERAL"
>hot_standby_feedback</TT
></A
> or to cancel long running queries on hot standbys, so there aren't any <SPAN
CLASS="QUOTE"
>"cancelling statement due to conflict with recovery"</SPAN
> errors.</P
></LI
><LI
><P
>Temporary tables may be used on replicas.</P
></LI
><LI
><P
>Tables that aren't being replicated from elsewhere may be written to BDR.</P
></LI
><LI
><P
>Replication across major versions (e.g. 9.4 to 9.5) can be supported (though BDR imposes limitations on that, <A
HREF="http://2ndquadrant.com/pglogical"
TARGET="_top"
>pglogical</A
> supports it well).</P
></LI
><LI
><P
>Replication across architectures and OSes (e.g. PPC64 Linux to x86_64 OS X) is supported.</P
></LI
><LI
><P
>Replication is per-database (or even table-level), whereas physical replication can and must replicate all databases. (<A
HREF="http://2ndquadrant.com/pglogical"
TARGET="_top"
>pglogical</A
> even supports row- and column-level filtering of replication).</P
></LI
><LI
><P
>BDR's logical replication implementation imposes some restrictions on supported DDL (see: <A
HREF="ddl-replication.html"
>DDL replication</A
>) that do not apply for physical replication</P
></LI
><LI
><P
>Because it's database-level not cluster-level, commands that affect all databases, like <TT
CLASS="LITERAL"
>ALTER SYSTEM</TT
> or <TT
CLASS="LITERAL"
>CREATE ROLE</TT
> are <SPAN
CLASS="emphasis"
><I
CLASS="EMPHASIS"
>not</I
></SPAN
> replicated by BDR and must be managed by the administrator.</P
></LI
><LI
><P
>Disk random I/O requirements and flush frequency may be higher than for physical replication.</P
></LI
><LI
><P
>Only completed transactions are replicated. Big transactions may have longer replication delays because replication doesn't start until the transaction completes. Aborted transactions' writes are never replicated at all.</P
></LI
><LI
><P
>Logical replication requires at least PostgreSQL 9.4.</P
></LI
><LI
><P
>Logical replication cannot be used for point-in-time recovery (though it can support a replication delay). It's technically possible to add this capability if someone needs it, though.</P
></LI
><LI
><P
>Logical replication only works via streaming, not WAL file archiving, and requires the use of a <A
HREF="http://www.postgresql.org/docs/current/static/logicaldecoding-explanation.html"
TARGET="_top"
>replication slot</A
>.</P
></LI
><LI
><P
>Cascading replication is not (yet) supported by logical replication.</P
></LI
><LI
><P
>Large objects (pg_largeobject, lo_create, and so on) are not handled by logical decoding, so it cannot be replicated by BDR</P
></LI
><LI
><P
>Sequence updates are not replicated by logical replication, as the underlying logical decoding facility does not support them. Traditional sequences don't work in a multimaster environment anyway, so BDR offers alternatives.</P
></LI
></UL
><P>
  </P
><P
>   Most users will want to use physical replication and/or WAL archiving for
   redundancy, high availability, backup and PITR.  Logical replication is well
   suited to data integration, data movement and data aggregation (often as an
   alternative to or combined with ETL), for scale-out and for distributed
   multi-master deployments.
  </P
><P
>   It's possible to replicate between different PostgreSQL versions, operating systems
   and/or processor architectures using logical replication because it can fall back
   to sending data in text form - just like SQL. Where the servers are compatible
   it can use the faster-to-process binary representation or an intermediate form.
   Logical replication cannot prevent all possible incompatibilities though - for
   example, it isn't possible to replicate a type added in PostgreSQL 9.5 to PostgreSQL
   9.4 because 9.4 has no way to store and represent it.
  </P
><P
>   Unlike physical replication, which replicates all databases on a PostgreSQL
   install, logical decoding permits (and requires) separate replication of
   each database. It can also replicate a subset of tables within a database.
   It is not possible to configure wildcard replication of all databases on a
   server in logical replication. You can replicate multiple databases, but
   each database must be configured separately.
  </P
><P
>   Temporary tables may always be created on all nodes, even if they are also
   receiving replicated data. There's no prohibition against doing so like it
   exists for PostgreSQL's block-level replication features.
  </P
><P
>   Local writes are not limited to temporary tables.
   <TT
CLASS="LITERAL"
>UNLOGGED</TT
> tables may be created even on nodes that are
   receiving changes from upstream/peer nodes. Additionally, replication sets
   allow changes to only a subset of tables to be replicated if desired, so some
   normal tables may be excluded from replication.  This makes BDR very
   useful for use cases where significant work is done on nodes that also
   receive replicated data from elsewhere.
  </P
><P
>   Logical replication doesn't start replicating a transaction until it
   commits. This can cause longer replication delays for big transactions than
   physical replication, where the transaction's changes get replicated as soon
   as they're written. It also lets logical replication entirely skip
   replication of writes by aborted transactions. Future enhancements to
   logical decoding may permit streaming of transactions before they're
   committed.
  </P
><P
>   Because logical replication is only supported in streaming mode (rather
   than WAL archiving) it isn't suitable for point-in-time recovery. Logical
   replication may be used in conjunction with streaming physical replication
   and/or PITR, though; it is not necessary to choose one or the other.
  </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="bdr-concepts.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="bdr-vs-trigger-based.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Concepts</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="overview.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Differences between BDR and trigger-based replication</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>