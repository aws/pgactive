<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML
><HEAD
><TITLE
>Monitoring node join/removal</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK
REV="MADE"
HREF="mailto: bdr-list@2ndquadrant.com"><LINK
REL="HOME"
TITLE="BDR 2.0.6 Documentation"
HREF="index.html"><LINK
REL="UP"
TITLE="Monitoring"
HREF="monitoring.html"><LINK
REL="PREVIOUS"
TITLE="Why monitoring matters"
HREF="monitoring-why.html"><LINK
REL="NEXT"
TITLE="Monitoring replication peers"
HREF="monitoring-peers.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="website-docs.css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=ISO-8859-1"><META
NAME="creation"
CONTENT="2023-04-11T13:16:52"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="4"
ALIGN="center"
VALIGN="bottom"
><A
HREF="index.html"
>BDR 2.0.6 Documentation</A
></TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
TITLE="Why monitoring matters"
HREF="monitoring-why.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="monitoring.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>Chapter 7. Monitoring</TD
><TD
WIDTH="20%"
ALIGN="right"
VALIGN="top"
><A
TITLE="Monitoring replication peers"
HREF="monitoring-peers.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="MONITORING-NODE-JOIN-REMOVE"
>7.2. Monitoring node join/removal</A
></H1
><P
>   Node join and removal is asynchronous in BDR. The <A
HREF="functions-node-mgmt.html"
>Node management functions</A
> return immediately, without first
   ensuring the join or part operation is complete. To see when a join or
   part operation finishes it is necessary to check the node state indirectly
   via <A
HREF="catalog-bdr-nodes.html"
>bdr.bdr_nodes</A
> or using helper functions.
  </P
><P
>   The helper function <A
HREF="functions-node-mgmt.html#FUNCTION-BDR-NODE-JOIN-WAIT-FOR-READY"
>bdr.bdr_node_join_wait_for_ready</A
>, when called, will cause
   a PostgreSQL session to pause until outstanding node join operations
   complete. More helpers for node status monitoring will be added over
   time.
  </P
><P
>   For other node status monitoring <A
HREF="catalog-bdr-nodes.html"
>bdr.bdr_nodes</A
>
   or must be queried directly.
  </P
><P
>    Here is an example of a <TT
CLASS="LITERAL"
>SELECT</TT
> from
    <TT
CLASS="LITERAL"
>bdr.bdr_nodes</TT
> that indicates that one node is ready
    (<TT
CLASS="LITERAL"
>r</TT
>), one node has been removed/killed
    (<TT
CLASS="LITERAL"
>k</TT
>), and one node is initializing (<TT
CLASS="LITERAL"
>i</TT
>):
    </P><PRE
CLASS="PROGRAMLISTING"
>    SELECT * FROM bdr.bdr_nodes;
         node_sysid      | node_timeline | node_dboid | node_status | node_name |      node_local_dsn      |    node_init_from_dsn
    ---------------------+---------------+------------+-------------+-----------+--------------------------+--------------------------
     6125823754033780536 |             1 |      16385 | r           | node1     | port=5598 dbname=bdrdemo |
     6125823714403985168 |             1 |      16386 | k           | node2     | port=5599 dbname=bdrdemo | port=5598 dbname=bdrdemo
     6125847382076805699 |             1 |      16386 | i           | node3     | port=6000 dbname=bdrdemo | port=5598 dbname=bdrdemo
    (3 rows)
    </PRE
><P>
  </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="monitoring-why.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="monitoring-peers.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Why monitoring matters</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="monitoring.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Monitoring replication peers</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>